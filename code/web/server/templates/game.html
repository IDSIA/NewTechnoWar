{% extends "layout.html" %}

{% block pagestyles %}
    <link href="{{ url_for('static', filename='css/game.css', version='20200603') }}" rel="stylesheet" type="text/css">
{% endblock %}

{% block content %}
    <div id="cockpit">
        <div id="title">
            <a id="home" href="{{ url_for('main.index') }}">üèö</a>
            <h1>New Techno War - AI Demo</h1>
            <a id="btnReset" href="{{ url_for('main.gameReset') }}">‚Ü©</a>
            <a id="btnNext" onclick="step()">‚ñ∂</a>
            {# <a id="btnForward" onclick="turn()">‚ñ∂‚ñ∂|</a> #}
            <a id="btnTurn">{{ turn }}</a>
        </div>
        <label for="console"></label>
        <textarea id="console" readonly></textarea>
    </div>
    <div id="gameLayout">
        <div id="redUnits" class="units red">
            <h1 id="redPlayer" class="player-title"></h1>
        </div>
        <div id="gameBoard">
            <svg id="view" viewBox="{{ vb[0] }} {{ vb[1] }} {{ vb[2] }} {{ vb[3] }}">
                <defs>
                    <polygon id="hex" class="hex" points="5,-9 -5,-9 -10,0 -5,9 5,9 10,0"></polygon>
                    <pattern id="infantryMark" x="0" y="0" patternUnits="userSpaceOnUse" height="1" width="1">
                        <image href="{{ url_for('static', filename='img/infantry.png') }}"></image>
                    </pattern>
                    <pattern id="tankMark" x="0" y="0" patternUnits="userSpaceOnUse" height="1" width="1">
                        <image href="{{ url_for('static', filename='img/tank.png') }}"></image>
                    </pattern>
                </defs>
                <g id="board">
                    {% for hex in board %}
                        <g id="x{{ hex.i }}y{{ hex.j }}"
                           transform="translate({{ hex.x }}, {{ hex.y }})"
                           onclick="human.clickHexagon({{ hex.i }}, {{ hex.j }})"
                        >
                            <use href="#hex" class="hexagon {{ hex.css() }}"></use>
                            <text class="content" x="0" y="0">
                                {% if hex.objective %}
                                    ‚≠ê
                                {% endif %}
                                {# {% if hex.blockLos %}#}
                                {# üöß#}
                                {# {% endif %}#}
                                {% if hex.terrain.name == 'Building' %}
                                    üèØ
                                {% endif %}
                                {% if hex.terrain.name == 'Isolated tree cover' %}
                                    üå≥
                                {% endif %}
                                {% if hex.terrain.name == 'Forest' %}
                                    üå≤
                                {% endif %}
                                {% if hex.terrain.name == 'Urban' %}
                                    üèô
                                {% endif %}
                            </text>
                            <text class="coord" x="0" y="6">({{ hex.i }},{{ hex.j }})</text>
                        </g>
                    {% endfor %}
                </g>
                <g id="zones">
                    {% for hex in pzRed %}
                        <g id="x{{ hex.i }}y{{ hex.j }}"
                           transform="translate({{ hex.x }}, {{ hex.y }})"
                           onclick="human.clickHexagon({{ hex.i }}, {{ hex.j }})"
                        >
                            <use href="#hex" class="pz-red"></use>
                        </g>
                    {% endfor %}
                    {% for hex in pzBlue %}
                        <g id="x{{ hex.i }}y{{ hex.j }}"
                           transform="translate({{ hex.x }}, {{ hex.y }})"
                           onclick="human.clickHexagon({{ hex.i }}, {{ hex.j }})"
                        >
                            <use href="#hex" class="pz-blue"></use>
                        </g>

                    {% endfor %}
                </g>
                <g id="actions">
                    <g id="moves"></g>
                    <g id="shoots"></g>
                    <g id="responses"></g>
                </g>
                <g id="markers"></g>
            </svg>
        </div>
        <div id="blueUnits" class="units blue">
            <h1 id="bluePlayer" class="player-title"></h1>
        </div>
    </div>
{% endblock %}

{% block additionalscripts %}
    <script src="{{ url_for('static', filename='js/svg-pan-zoom.js', version='20200818') }}"></script>
    <script src="{{ url_for('static', filename='js/human.js', version='20200818') }}"></script>
    <script src="{{ url_for('static', filename='js/game.js', version='20200818') }}"></script>
{% endblock %}
